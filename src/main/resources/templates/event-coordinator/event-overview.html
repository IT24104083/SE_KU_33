<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Event Overview - Event Coordinator</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" th:href="@{/style.css}">
</head>
<body>
<!-- Animated background elements -->
<div class="bg-element bg-element-1"></div>
<div class="bg-element bg-element-2"></div>
<div class="bg-element bg-element-3"></div>

<div class="container">
  <div class="header">
    <div class="logo">
      <i class="fas fa-calendar-check logo-icon"></i>
      <span>EventSlate</span>
    </div>
    <h1>
      Event #<span th:text="${event.EventID}"></span> Overview
      <span class="status-badge" th:classappend="'status-' + ${event.Status?.toLowerCase()}"
            th:text="${event.Status}"></span>
    </h1>
    <div class="header-actions">
      <a th:href="@{/event-coordinator/dashboard}" class="btn-cancel">
        <i class="fas fa-arrow-left"></i> Dashboard
      </a>
      <a th:href="@{/event-coordinator/events/needing-assignments}" class="btn-primary">
        <i class="fas fa-tasks"></i> All Assignments
      </a>
    </div>
  </div>

  <!-- Flash Messages -->
  <div th:if="${success}" class="alert alert-success">
    <i class="fas fa-check-circle"></i>
    <span th:text="${success}"></span>
  </div>
  <div th:if="${error}" class="alert alert-error">
    <i class="fas fa-exclamation-circle"></i>
    <span th:text="${error}"></span>
  </div>

  <!-- Event Details -->
  <div class="vendor-section">
    <div class="section-header">
      <h2 class="section-title">
        <i class="fas fa-info-circle section-icon"></i> Event Details
      </h2>
      <span class="vendor-count">Event Management</span>
    </div>
    <div class="event-details-grid">
      <div class="event-detail-group">
        <div class="event-detail-item">
          <div class="event-detail-icon">
            <i class="fas fa-star"></i>
          </div>
          <div class="event-detail-content">
            <label>Event Type</label>
            <span class="event-detail-value" th:text="${event.EventType}"></span>
          </div>
        </div>
        <div class="event-detail-item">
          <div class="event-detail-icon">
            <i class="fas fa-calendar-day"></i>
          </div>
          <div class="event-detail-content">
            <label>Event Date</label>
            <span class="event-detail-value" th:text="${#dates.format(event.EventDate, 'MMMM dd, yyyy')}"></span>
          </div>
        </div>
        <div class="event-detail-item">
          <div class="event-detail-icon">
            <i class="fas fa-tag"></i>
          </div>
          <div class="event-detail-content">
            <label>Status</label>
            <span class="status-badge" th:classappend="'status-' + ${event.Status?.toLowerCase()}"
                  th:text="${event.Status}"></span>
          </div>
        </div>
      </div>
      <div class="event-detail-group">
        <div class="event-detail-item">
          <div class="event-detail-icon">
            <i class="fas fa-user"></i>
          </div>
          <div class="event-detail-content">
            <label>Customer</label>
            <span class="event-detail-value" th:text="${event.Customer_Name}"></span>
          </div>
        </div>
        <div class="event-detail-item">
          <div class="event-detail-icon">
            <i class="fas fa-envelope"></i>
          </div>
          <div class="event-detail-content">
            <label>Email</label>
            <span class="event-detail-value" th:text="${event.Email}"></span>
          </div>
        </div>
        <div class="event-detail-item">
          <div class="event-detail-icon">
            <i class="fas fa-phone"></i>
          </div>
          <div class="event-detail-content">
            <label>Phone</label>
            <span class="event-detail-value" th:text="${event.Phone} ?: 'Not provided'"></span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Overview Cards -->
  <div class="overview-cards">
    <!-- Venue Card -->
    <div class="overview-card">
      <div class="overview-card-header">
        <div class="overview-icon">
          <i class="fas fa-building"></i>
        </div>
        <h3>Venue</h3>
      </div>
      <div class="overview-status" th:classappend="${venueAssigned} ? 'status-assigned' : 'status-pending'">
        <div class="status-indicator" th:classappend="${venueAssigned} ? 'assigned' : 'pending'"></div>
        <span th:text="${venueAssigned} ? 'Assigned' : 'Pending'"></span>
      </div>
      <div class="overview-number" th:classappend="${venueAssigned} ? 'assigned' : 'pending'">
        <i th:classappend="${venueAssigned} ? 'fas fa-check' : 'fas fa-times'"></i>
      </div>
      <p th:text="${venueAssigned} ? 'Venue successfully assigned' : 'No venue assigned yet'"></p>
      <a th:href="@{/event-coordinator/events/manage/{id}/venue(id=${event.EventID})}"
         class="btn-overview">
        <i class="fas fa-cog"></i> Manage Venue
      </a>
    </div>

    <!-- Vendors Card -->
    <div class="overview-card">
      <div class="overview-card-header">
        <div class="overview-icon">
          <i class="fas fa-users-cog"></i>
        </div>
        <h3>Vendors</h3>
      </div>
      <div class="overview-status" th:classappend="${assignedVendorsCount > 0} ? 'status-assigned' : 'status-pending'">
        <div class="status-indicator" th:classappend="${assignedVendorsCount > 0} ? 'assigned' : 'pending'"></div>
        <span th:text="${assignedVendorsCount > 0} ? 'Assigned' : 'Pending'"></span>
      </div>
      <div class="overview-number" th:text="${assignedVendorsCount}">0</div>
      <p>Services Assigned</p>
      <a th:href="@{/event-coordinator/events/manage/{id}/vendors(id=${event.EventID})}"
         class="btn-overview">
        <i class="fas fa-cog"></i> Manage Vendors
      </a>
    </div>

    <!-- Services Card -->
    <div class="overview-card">
      <div class="overview-card-header">
        <div class="overview-icon">
          <i class="fas fa-concierge-bell"></i>
        </div>
        <h3>Requested Services</h3>
      </div>
      <div class="overview-status status-requested">
        <div class="status-indicator requested"></div>
        <span>Requested</span>
      </div>
      <div class="overview-number" th:text="${(inquiry.Photographer ? 1 : 0) + (inquiry.Catering ? 1 : 0) + (inquiry.DJ ? 1 : 0) + (inquiry.Decorations ? 1 : 0)}">0</div>
      <p>Services Requested</p>
      <div class="service-badges">
          <span th:if="${inquiry.Photographer}" class="service-badge">
            <i class="fas fa-camera"></i> Photographer
          </span>
        <span th:if="${inquiry.Catering}" class="service-badge">
            <i class="fas fa-utensils"></i> Catering
          </span>
        <span th:if="${inquiry.DJ}" class="service-badge">
            <i class="fas fa-music"></i> DJ
          </span>
        <span th:if="${inquiry.Decorations}" class="service-badge">
            <i class="fas fa-paint-brush"></i> Decorations
          </span>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="vendor-section">
    <div class="section-header">
      <h2 class="section-title">
        <i class="fas fa-bolt section-icon"></i> Quick Actions
      </h2>
    </div>
    <div class="quick-actions-grid">
      <a th:href="@{/event-coordinator/events/manage/{id}/venue(id=${event.EventID})}" class="quick-action-large">
        <div class="action-icon-large">
          <i class="fas fa-building"></i>
        </div>
        <div class="action-content-large">
          <h4>Manage Venue</h4>
          <p>Assign or change the event venue</p>
        </div>
      </a>

      <a th:href="@{/event-coordinator/events/manage/{id}/vendors(id=${event.EventID})}" class="quick-action-large">
        <div class="action-icon-large">
          <i class="fas fa-users-cog"></i>
        </div>
        <div class="action-content-large">
          <h4>Manage Vendors</h4>
          <p>Assign vendors to requested services</p>
        </div>
      </a>

      <form th:action="@{/event-coordinator/events/confirm-event}" method="post" class="quick-action-large confirm-form">
        <input type="hidden" name="eventId" th:value="${event.EventID}">
        <button type="submit" class="confirm-button"
                th:disabled="${event.Status == 'Confirmed'}"
                onclick="return confirm('Are you sure you want to confirm this event? This will finalize all assignments.')">
          <div class="action-icon-large">
            <i class="fas fa-check-circle"></i>
          </div>
          <div class="action-content-large">
            <h4>Confirm Event</h4>
            <p>Finalize all assignments and confirm event</p>
          </div>
        </button>
      </form>
    </div>
  </div>

  <!-- Assigned Vendors Preview -->
  <div class="vendor-section" th:if="${assignedVendors != null and !assignedVendors.empty}">
    <div class="section-header">
      <h2 class="section-title">
        <i class="fas fa-users section-icon"></i> Currently Assigned Vendors
      </h2>
      <span class="vendor-count" th:text="${assignedVendors.size()} + ' vendors'"></span>
    </div>
    <div class="assigned-vendors-grid">
      <div th:each="vendor : ${assignedVendors}" class="vendor-assignment-card">
        <div class="vendor-service-icon">
          <i th:classappend="'fas ' + ${vendor.ServiceType == 'Photographer'} ? 'fa-camera' :
                              ${vendor.ServiceType == 'Catering'} ? 'fa-utensils' :
                              ${vendor.ServiceType == 'DJ'} ? 'fa-music' : 'fa-paint-brush'"></i>
        </div>
        <div class="vendor-assignment-content">
          <h4 th:text="${vendor.ServiceType}"></h4>
          <div class="vendor-details">
            <p><strong>Vendor:</strong> <span th:text="${vendor.VendorName}"></span></p>
            <p><strong>Price:</strong> <span class="price" th:text="'LKR ' + ${#numbers.formatDecimal(vendor.Price, 0, 'COMMA', 2, 'POINT')}"></span></p>
            <p><strong>Contact:</strong> <span th:text="${vendor.ContactNo}"></span></p>
          </div>
        </div>
        <div class="vendor-status assigned">
          <i class="fas fa-check"></i>
          <span>Assigned</span>
        </div>
      </div>
    </div>
  </div>

  <!-- System Status Footer -->
  <div class="system-status-footer">
    <div class="status-item">
      <div class="status-indicator online"></div>
      <span>Event Management: <strong>Active</strong></span>
    </div>
    <div class="status-item">
      <i class="fas fa-calendar-alt"></i>
      <span>Event Date: <strong th:text="${#dates.format(event.EventDate, 'MMM dd, yyyy')}"></strong></span>
    </div>
    <div class="status-item">
      <i class="fas fa-user-cog"></i>
      <span>Coordinator: <strong>You</strong></span>
    </div>
  </div>
</div>

<script>
  // Add interactive effects
  document.addEventListener('DOMContentLoaded', function() {
    // Add hover effects to overview cards
    const overviewCards = document.querySelectorAll('.overview-card');
    overviewCards.forEach(card => {
      card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-5px)';
      });
      card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0)';
      });
    });

    // Add hover effects to quick actions
    const quickActions = document.querySelectorAll('.quick-action-large');
    quickActions.forEach(action => {
      action.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-3px)';
      });
      action.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0)';
      });
    });

    // Add vendor card animations
    const vendorCards = document.querySelectorAll('.vendor-assignment-card');
    vendorCards.forEach((card, index) => {
      card.style.animationDelay = `${index * 0.1}s`;
    });

    // Status indicator animation
    const statusIndicators = document.querySelectorAll('.status-indicator');
    setInterval(() => {
      statusIndicators.forEach(indicator => {
        if (indicator.classList.contains('assigned')) {
          indicator.classList.toggle('pulse');
        }
      });
    }, 2000);
  });
</script>
</body>
</html>